<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è‡ªå®šä¹‰å‡½æ•°åæµ‹è¯•é¡µé¢</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    .test-section {
      margin: 20px 0;
      padding: 20px;
      border: 1px solid #ddd;
      border-radius: 8px;
    }
    .test-element {
      padding: 20px;
      margin: 10px 0;
      background: #f0f0f0;
      border: 2px solid #333;
      cursor: pointer;
    }
    .test-element:hover {
      background: #e0e0e0;
    }
    .log {
      background: #000;
      color: #0f0;
      padding: 10px;
      font-family: monospace;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 10px;
    }
    .log-entry {
      margin: 5px 0;
    }
    .log-entry.info { color: #0ff; }
    .log-entry.success { color: #0f0; }
    .log-entry.error { color: #f00; }
    h2 {
      color: #333;
    }
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <h1>è‡ªå®šä¹‰å‡½æ•°åæµ‹è¯•é¡µé¢</h1>
  
  <div class="test-section">
    <h2>æµ‹è¯•è¯´æ˜</h2>
    <p>æœ¬é¡µé¢ç”¨äºæµ‹è¯• Schema Editor æ’ä»¶çš„è‡ªå®šä¹‰å‡½æ•°ååŠŸèƒ½ã€‚</p>
    <ol>
      <li>æ‰“å¼€æ’ä»¶çš„é€‰é¡¹é¡µé¢ï¼ˆå³é”®ç‚¹å‡»æ’ä»¶å›¾æ ‡ â†’ é€‰é¡¹ï¼‰</li>
      <li>åœ¨"APIå‡½æ•°é…ç½®"ä¸­ä¿®æ”¹å‡½æ•°åï¼š
        <ul>
          <li>è·å–Schemaå‡½æ•°åï¼š<code>myCustomGetSchema</code></li>
          <li>æ›´æ–°Schemaå‡½æ•°åï¼š<code>myCustomUpdateSchema</code></li>
        </ul>
      </li>
      <li>ä¿å­˜è®¾ç½®å¹¶åˆ·æ–°æœ¬é¡µé¢</li>
      <li>æ¿€æ´»æ’ä»¶ï¼ŒæŒ‰ä½ Alt/Option é”®æ‚¬åœå¹¶ç‚¹å‡»ä¸‹æ–¹çš„æµ‹è¯•å…ƒç´ </li>
    </ol>
  </div>

  <div class="test-section">
    <h2>æµ‹è¯•å…ƒç´  1 - é»˜è®¤å‡½æ•°å</h2>
    <p>ä½¿ç”¨é»˜è®¤å‡½æ•°åï¼š<code>window.__getSchemaByParams</code> å’Œ <code>window.__updateSchemaByParams</code></p>
    <div class="test-element" data-schema-params="user,profile,default">
      ç‚¹å‡»æˆ‘æµ‹è¯•é»˜è®¤å‡½æ•°å
    </div>
  </div>

  <div class="test-section">
    <h2>æµ‹è¯•å…ƒç´  2 - è‡ªå®šä¹‰å‡½æ•°å</h2>
    <p>ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°åï¼š<code>window.myCustomGetSchema</code> å’Œ <code>window.myCustomUpdateSchema</code></p>
    <div class="test-element" data-schema-params="product,detail,custom">
      ç‚¹å‡»æˆ‘æµ‹è¯•è‡ªå®šä¹‰å‡½æ•°å
    </div>
  </div>

  <div class="test-section">
    <h2>è°ƒç”¨æ—¥å¿—</h2>
    <div class="log" id="log"></div>
  </div>

  <script>
    const logContainer = document.getElementById('log')

    function addLog(type, message, data) {
      const entry = document.createElement('div')
      entry.className = `log-entry ${type}`
      const timestamp = new Date().toLocaleTimeString()
      entry.textContent = `[${timestamp}] ${message}`
      if (data) {
        entry.textContent += ` ${JSON.stringify(data)}`
      }
      logContainer.appendChild(entry)
      logContainer.scrollTop = logContainer.scrollHeight
    }

    // é»˜è®¤å‡½æ•°åå®ç°
    window.__getSchemaByParams = (params) => {
      addLog('info', 'ğŸ” è°ƒç”¨ __getSchemaByParams (é»˜è®¤)', { params })
      return {
        type: 'default',
        params: params,
        data: {
          name: 'æµ‹è¯•æ•°æ®',
          value: 123,
          timestamp: Date.now()
        }
      }
    }

    window.__updateSchemaByParams = (schema, params) => {
      addLog('info', 'ğŸ’¾ è°ƒç”¨ __updateSchemaByParams (é»˜è®¤)', { schema, params })
      addLog('success', 'âœ… é»˜è®¤å‡½æ•°æ›´æ–°æˆåŠŸ')
      return true
    }

    // è‡ªå®šä¹‰å‡½æ•°åå®ç°
    window.myCustomGetSchema = (params) => {
      addLog('info', 'ğŸ” è°ƒç”¨ myCustomGetSchema (è‡ªå®šä¹‰)', { params })
      return {
        type: 'custom',
        params: params,
        data: {
          name: 'è‡ªå®šä¹‰æµ‹è¯•æ•°æ®',
          value: 456,
          customField: 'This is custom',
          timestamp: Date.now()
        }
      }
    }

    window.myCustomUpdateSchema = (schema, params) => {
      addLog('info', 'ğŸ’¾ è°ƒç”¨ myCustomUpdateSchema (è‡ªå®šä¹‰)', { schema, params })
      addLog('success', 'âœ… è‡ªå®šä¹‰å‡½æ•°æ›´æ–°æˆåŠŸ')
      return true
    }

    addLog('success', 'âœ… é¡µé¢åŠ è½½å®Œæˆï¼Œæ‰€æœ‰å‡½æ•°å·²æ³¨å†Œ')
    addLog('info', 'ğŸ“‹ å·²æ³¨å†Œå‡½æ•°ï¼š__getSchemaByParams, __updateSchemaByParams, myCustomGetSchema, myCustomUpdateSchema')
  </script>
</body>
</html>


# 导入导出

Schema Element Editor 支持将 Schema 数据导出为 JSON 文件，也可以从文件导入数据到编辑器。

## 功能概述

导入导出功能支持：

- 📤 **导出** - 将当前编辑内容保存为 JSON 文件
- 📥 **导入** - 从 JSON 文件加载内容到编辑器

<!-- screenshot: 导入导出按钮位置（标题栏） -->

## 导出功能

### 使用方法

1. 在编辑器中准备好要导出的内容
2. 点击标题栏的「导出」按钮（下载图标）
3. 文件自动下载到本地

<!-- screenshot: 点击导出按钮 -->

### 导出文件格式

导出的文件包含元数据，格式如下：

```json
{
  "__SCHEMA_ELEMENT_EDITOR_EXPORT__": true,
  "content": {
    "type": "paragraph",
    "children": [{ "text": "示例内容" }]
  },
  "metadata": {
    "params": "message-1",
    "exportedAt": "2025-12-07T10:30:00.000Z",
    "version": "1.26.0",
    "wasStringData": false,
    "url": "https://example.com/page"
  }
}
```

| 字段                               | 说明                                                |
| ---------------------------------- | --------------------------------------------------- |
| `__SCHEMA_ELEMENT_EDITOR_EXPORT__` | 文件标识，表示这是 Schema Element Editor 导出的文件 |
| `content`                          | 实际的 Schema 数据                                  |
| `metadata.params`                  | 元素参数                                            |
| `metadata.exportedAt`              | 导出时间                                            |
| `metadata.version`                 | 插件版本                                            |
| `metadata.wasStringData`           | 原始数据是否为字符串类型                            |
| `metadata.url`                     | 导出时的页面 URL                                    |

### 文件名规则

默认文件名格式：`content-{params}-{timestamp}.json`

例如：`content-message-1-20251207103000.json`

### 自定义文件名

如果希望导出时自定义文件名：

1. 打开配置页面
2. 找到「数据管理」→「导出配置」
3. 开启「导出时自定义文件名」
4. 之后导出时会弹出对话框让您输入文件名

<!-- screenshot: 自定义文件名配置 -->

### 导出限制

- 当前内容必须是有效的 JSON
- 如果存在 JSON 语法错误，导出按钮会被禁用

## 导入功能

### 使用方法

1. 点击标题栏的「导入」按钮（上传图标）
2. 选择 JSON 文件
3. 确认导入（会覆盖当前编辑内容）

<!-- screenshot: 点击导入按钮 -->

### 智能格式检测

导入时会自动检测文件格式：

| 文件类型                       | 处理方式              |
| ------------------------------ | --------------------- |
| Schema Element Editor 导出文件 | 只加载 `content` 部分 |
| 普通 JSON 文件                 | 直接加载整个内容      |

### 文件要求

| 限制     | 说明              |
| -------- | ----------------- |
| 文件格式 | `.json` 文件      |
| 文件大小 | 最大 10MB         |
| 内容格式 | 必须是有效的 JSON |

### 导入后的变化

- 编辑器内容被替换为导入的数据
- 自动触发内容类型检测
- 记录一条历史版本

## 配置选项

在配置页面「数据管理」→「导出配置」中设置：

| 配置项             | 说明                         | 默认值 |
| ------------------ | ---------------------------- | ------ |
| 导出时自定义文件名 | 导出时弹窗让用户自定义文件名 | 关闭   |

## 功能开关

在「功能开关」→「工具栏按钮」中可以开启或关闭「导入导出」。

关闭后，标题栏不显示导入导出按钮。

## 使用场景

### 数据备份

1. 编辑好重要数据后导出
2. 文件保存到本地
3. 需要时重新导入

### 团队协作

1. 一人编辑好配置后导出
2. 发送文件给团队成员
3. 成员导入文件查看或继续编辑

### 跨设备迁移

1. 在设备 A 上导出数据
2. 将文件传输到设备 B
3. 在设备 B 上导入数据

### 版本存档

1. 每次重要修改后导出
2. 按日期/版本命名保存
3. 形成数据变更的历史存档

## 与其他功能配合

### 与收藏配合

- 导入的数据可以添加到收藏
- 收藏的内容可以先加载再导出

### 与草稿配合

- 导入后可以保存为草稿
- 草稿内容可以导出备份

### 与 Diff 配合

1. 导入旧版本数据
2. 与当前数据进行 Diff 对比
3. 查看变更

## 故障排除

### 导出按钮禁用

**原因**：当前内容存在 JSON 语法错误

**解决方案**：

1. 查看编辑器底部的错误提示
2. 修正 JSON 语法错误
3. 或点击「格式化」尝试自动修复

### 导入失败

**可能原因**：

1. 文件不是有效的 JSON
2. 文件大小超过 10MB
3. 文件读取失败

**解决方案**：

1. 检查文件内容是否为有效 JSON
2. 压缩或分割大文件
3. 重新选择文件

### 导入后内容类型不对

**原因**：导入的数据格式与预期不符

**解决方案**：

1. 检查导入的原始文件
2. 使用工具栏切换内容类型
3. 手动调整数据结构

### 导入后页面报错

**原因**：导入的数据与页面期望的格式不兼容

**解决方案**：

1. 不要直接保存到页面
2. 先在编辑器中调整数据结构
3. 确认兼容后再保存

---
alwaysApply: false
---

# Chrome插件发布流程

这是一个chrome插件项目，其代码托管在github上。

当用户说'执行发布流程'或者类似的命令时，你需要执行项目的发布流程。

## 发布流程步骤

### 1. 前置检查
- 检查git工作区状态（`git status`）
- 确认是否有未提交的改动，如有则提示用户先处理

### 2. 版本更新确认
向用户确认本次发布是否需要更新插件版本：
- **需要更新**：询问版本类型（major/minor/patch）
- **不需要更新**：跳过版本相关步骤，直接进入构建流程

### 3. 更新版本号（如需要）
同时更新以下文件中的版本号：
- `package.json` 中的 `version` 字段
- `manifest.json` 中的 `version` 字段
- 版本号格式：`major.minor.patch`（如 `1.2.3`）

### 4. 检查README文档更新
根据本次提交的改动内容，判断是否需要更新README文档：
- **需要更新的情况**：
  - 新增功能或移除功能
  - 修改了用户使用方式或配置方法
  - 更改了安装步骤或依赖要求
  - 修复了影响用户体验的重要问题
  - 更新了API或接口
- **检查要点**：
  - 功能介绍是否需要补充或修改
  - 使用说明是否需要更新
  - 截图或示例是否需要更换
- **操作**：
  - 向用户确认是否需要更新README
  - 如需要，帮助用户修改README
  - 等待用户完成对README修改的确认后继续后续流程

### 5. 构建打包
执行构建命令：`tnpm run build`
- 构建失败则终止流程，提示用户检查错误

### 6. 生成压缩包
执行打包命令：`tnpm run package`
- 打包失败则终止流程

### 7. 验证产物
检查生成的zip包是否存在且大小合理

### 8. 提交代码
- 总结本次代码改动
- 生成符合规范的commit message：
  - **提交信息质量要求**：必须清晰概括改动内容，让人一眼看懂做了什么
    - 使用有意义的动词描述具体行为（如：添加、修复、优化、重构）
    - 包含改动的核心要点，避免模糊描述（如：避免"update code"，应使用"fix: 修复用户登录验证逻辑"）
  - 有版本更新：`chore: release v{版本号}`
  - 无版本更新：根据改动类型选择前缀（`feat:`新功能/`fix:`修复/`refactor:`重构/`perf:`性能优化等）+ 具体改动描述
- **原子化提交原则**：每个提交应聚焦于单一具体功能或改动点
  - 如有多个独立功能改动，应分多次提交，每次只提交相关文件
  - 避免在一个提交中混合不相关的改动
  - 提交粒度：一个功能点/一个bug修复/一类相关的代码优化
- 执行提交：`git add {相关文件}` + `git commit -m "{message}"`（或对于发布流程使用 `git add .`）
- 推送到远程：`git push`

### 9. 创建并推送Tag（仅版本更新时）
- Tag命名格式：`v{版本号}`（如 `v1.2.3`）
- 创建tag：`git tag v{版本号}`
- 推送tag：`git push origin v{版本号}`

### 10. 生成Release内容（仅版本更新时）
生成适用于GitHub Release的内容：
- **Title格式**：`v{版本号}`
- **Description要求**：
  - 简洁明了，只概括核心改动点
  - 使用列表形式，每项一行
  - 分类展示（如：新增功能、问题修复、性能优化等）
  - 避免冗余描述和技术细节

### 11. 发布总结
向用户展示：
- 本次发布的版本号（如有）
- 改动摘要
- 生成的产物路径
- 下一步操作建议（如：手动上传zip到Chrome Web Store）

## 错误处理
任何步骤失败时：
1. 立即停止后续流程
2. 清晰告知失败的步骤和原因
3. 提供可能的解决建议
4. 等待用户处理后再继续
